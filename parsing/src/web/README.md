# Flask Сервис для обработки документов

Современный веб-сервис для загрузки и обработки DOCX и PDF файлов с генерацией Excel отчетов.

## Возможности

- ✅ Загрузка DOCX и PDF файлов
- ✅ Выбор полей для обработки (загружаются из `data/fields.json`)
- ✅ Превью обработки для первых 2 страниц
- ✅ Полная обработка файла с вызовом пользовательской логики
- ✅ Генерация Excel файлов для скачивания
- ✅ Современный и красивый интерфейс

## Установка

1. Установите зависимости:
```bash
pip install -r ../../../../requirements.txt
```

2. Убедитесь, что файл `data/fields.json` существует с полями по умолчанию

## Запуск

```bash
cd parsing/src/web
python app.py
```

Сервис будет доступен по адресу: http://localhost:5000

## Настройка пользовательской логики

### 1. Обработка файлов

Отредактируйте файл `utils/file_processor.py`:

- Метод `process_preview()` - логика для превью (первые 2 страницы)
- Метод `process_file()` - логика для полной обработки файла
- Метод `_apply_custom_logic()` - основная логика обработки текста

### 2. Поля по умолчанию

Измените файл `data/fields.json` для настройки доступных полей.

### 3. Отображение превью

В файле `static/js/app.js` найдите функцию `renderPreview()` и адаптируйте под свою структуру данных.

## Структура проекта

```
parsing/src/web/
├── app.py                 # Основное Flask приложение
├── config.py              # Конфигурация
├── templates/
│   └── index.html         # Главная страница
├── static/
│   ├── css/
│   │   └── style.css     # Стили
│   └── js/
│       └── app.js        # JavaScript логика
└── utils/
    ├── file_processor.py  # Обработка файлов
    ├── excel_generator.py # Генерация Excel
    └── field_loader.py    # Загрузка полей
```

## API Endpoints

- `GET /` - Главная страница
- `POST /api/upload` - Загрузка файла
- `GET /api/fields` - Получить список полей
- `POST /api/preview` - Генерация превью
- `POST /api/process` - Обработка файла
- `GET /api/download/<filename>` - Скачать Excel файл
- `POST /api/custom-logic` - Вызов пользовательской логики


